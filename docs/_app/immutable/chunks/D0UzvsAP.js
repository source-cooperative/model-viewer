import{Q as f,m as c,W as m,X as T,B as h,s as y}from"./Mxg7T9gF.js";const d=[{regex:new RegExp("^/nodes/\\d+/extensions/")}];class x{constructor(t,r){this._gltf=t,this._infoTree=r}convert(t){let r=this._gltf,n=this._infoTree,a;if(!t.startsWith("/"))throw new Error("Path must start with a /");const s=t.split("/");if(s.shift(),s[s.length-1].includes(".length")){const _=s[s.length-1].split(".");s.pop(),s.push(..._)}let g=!1;for(const b of s){const _=b==="length";if(_&&!n.__array__)throw new Error(`Path ${t} is invalid`);if(n.__ignoreObjectTree__&&(g=!0),n.__array__&&!_)n=n.__array__;else if(n=n[b],!n)throw new Error(`Path ${t} is invalid`);if(!g)if(r===void 0){if(!d.find(p=>p.regex.test(t)))throw new Error(`Path ${t} is invalid`)}else _||(r=r?.[b]);(n.__target__||_)&&(a=r)}return{object:a,info:n}}}const C={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonTransformNode),getPropertyName:[()=>"length"]},__array__:{__target__:!0,translation:{type:"Vector3",get:e=>e._babylonTransformNode?.position,set:(e,t)=>t._babylonTransformNode?.position.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"position"]},rotation:{type:"Quaternion",get:e=>e._babylonTransformNode?.rotationQuaternion,set:(e,t)=>t._babylonTransformNode?.rotationQuaternion?.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"rotationQuaternion"]},scale:{type:"Vector3",get:e=>e._babylonTransformNode?.scaling,set:(e,t)=>t._babylonTransformNode?.scaling.copyFrom(e),getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"scaling"]},weights:{length:{type:"number",get:e=>e._numMorphTargets,getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},__array__:{__target__:!0,type:"number",get:(e,t)=>t!==void 0?e._primitiveBabylonMeshes?.[0].morphTargetManager?.getTarget(t).influence:void 0,getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},type:"number[]",get:(e,t)=>[0],getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"influence"]},matrix:{type:"Matrix",get:e=>c.Compose(e._babylonTransformNode?.scaling,e._babylonTransformNode?.rotationQuaternion,e._babylonTransformNode?.position),getTarget:e=>e._babylonTransformNode,isReadOnly:!0},globalMatrix:{type:"Matrix",get:e=>{const t=c.Identity();let r=e.parent;for(;r&&r.parent;)r=r.parent;const n=e._babylonTransformNode?.position._isDirty||e._babylonTransformNode?.rotationQuaternion?._isDirty||e._babylonTransformNode?.scaling._isDirty;if(r){const a=r._babylonTransformNode?.computeWorldMatrix(!0).invert();a&&e._babylonTransformNode?.computeWorldMatrix(n)?.multiplyToRef(a,t)}else e._babylonTransformNode&&t.copyFrom(e._babylonTransformNode.computeWorldMatrix(n));return t},getTarget:e=>e._babylonTransformNode,isReadOnly:!0},extensions:{EXT_lights_ies:{multiplier:{type:"number",get:e=>e._babylonTransformNode?.getChildren(t=>t instanceof y,!0)[0]?.intensity,getTarget:e=>e._babylonTransformNode?.getChildren(t=>t instanceof y,!0)[0],set:(e,t)=>{if(t._babylonTransformNode){const r=t._babylonTransformNode.getChildren(n=>n instanceof y,!0)[0];r&&(r.intensity=e)}}},color:{type:"Color3",get:e=>e._babylonTransformNode?.getChildren(t=>t instanceof y,!0)[0]?.diffuse,getTarget:e=>e._babylonTransformNode?.getChildren(t=>t instanceof y,!0)[0],set:(e,t)=>{if(t._babylonTransformNode){const r=t._babylonTransformNode.getChildren(n=>n instanceof y,!0)[0];r&&(r.diffuse=e)}}}},KHR_node_visibility:{visible:{type:"boolean",get:e=>e._primitiveBabylonMeshes?e._primitiveBabylonMeshes[0].isVisible:!1,getTarget:()=>{},set:(e,t)=>{t._primitiveBabylonMeshes&&t._primitiveBabylonMeshes.forEach(r=>r.isVisible=e)}}}}}},N={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonAnimationGroup),getPropertyName:[()=>"length"]},__array__:{}},R={length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t.primitives[0]._instanceData?.babylonSourceMesh),getPropertyName:[()=>"length"]},__array__:{}},P={__array__:{__target__:!0,orthographic:{xmag:{componentsCount:2,type:"Vector2",get:e=>new m(e._babylonCamera?.orthoLeft??0,e._babylonCamera?.orthoRight??0),set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.orthoLeft=e.x,t._babylonCamera.orthoRight=e.y)},getTarget:e=>e,getPropertyName:[()=>"orthoLeft",()=>"orthoRight"]},ymag:{componentsCount:2,type:"Vector2",get:e=>new m(e._babylonCamera?.orthoBottom??0,e._babylonCamera?.orthoTop??0),set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.orthoBottom=e.x,t._babylonCamera.orthoTop=e.y)},getTarget:e=>e,getPropertyName:[()=>"orthoBottom",()=>"orthoTop"]},zfar:{type:"number",get:e=>e._babylonCamera?.maxZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.maxZ=e)},getTarget:e=>e,getPropertyName:[()=>"maxZ"]},znear:{type:"number",get:e=>e._babylonCamera?.minZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.minZ=e)},getTarget:e=>e,getPropertyName:[()=>"minZ"]}},perspective:{aspectRatio:{type:"number",get:e=>e._babylonCamera?.getEngine().getAspectRatio(e._babylonCamera),getTarget:e=>e,getPropertyName:[()=>"aspectRatio"],isReadOnly:!0},yfov:{type:"number",get:e=>e._babylonCamera?.fov,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.fov=e)},getTarget:e=>e,getPropertyName:[()=>"fov"]},zfar:{type:"number",get:e=>e._babylonCamera?.maxZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.maxZ=e)},getTarget:e=>e,getPropertyName:[()=>"maxZ"]},znear:{type:"number",get:e=>e._babylonCamera?.minZ,set:(e,t)=>{t._babylonCamera&&(t._babylonCamera.minZ=e)},getTarget:e=>e,getPropertyName:[()=>"minZ"]}}}},L={__array__:{__target__:!0,emissiveFactor:{type:"Color3",get:(e,t,r)=>o(e,t,r).emissiveColor,set:(e,t,r,n)=>o(t,r,n).emissiveColor.copyFrom(e),getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"emissiveColor"]},emissiveTexture:{extensions:{KHR_texture_transform:i("emissiveTexture")}},normalTexture:{scale:{type:"number",get:(e,t,r)=>l(e,r,"bumpTexture")?.level,set:(e,t,r,n)=>{const a=l(t,n,"bumpTexture");a&&(a.level=e)},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"level"]},extensions:{KHR_texture_transform:i("bumpTexture")}},occlusionTexture:{strength:{type:"number",get:(e,t,r)=>o(e,t,r).ambientTextureStrength,set:(e,t,r,n)=>{const a=o(t,r,n);a&&(a.ambientTextureStrength=e)},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"ambientTextureStrength"]},extensions:{KHR_texture_transform:i("ambientTexture")}},pbrMetallicRoughness:{baseColorFactor:{type:"Color4",get:(e,t,r)=>{const n=o(e,t,r);return T.FromColor3(n.albedoColor,n.alpha)},set:(e,t,r,n)=>{const a=o(t,r,n);a.albedoColor.set(e.r,e.g,e.b),a.alpha=e.a},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"albedoColor",()=>"alpha"]},baseColorTexture:{extensions:{KHR_texture_transform:i("albedoTexture")}},metallicFactor:{type:"number",get:(e,t,r)=>o(e,t,r).metallic,set:(e,t,r,n)=>{const a=o(t,r,n);a&&(a.metallic=e)},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"metallic"]},roughnessFactor:{type:"number",get:(e,t,r)=>o(e,t,r).roughness,set:(e,t,r,n)=>{const a=o(t,r,n);a&&(a.roughness=e)},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"roughness"]},metallicRoughnessTexture:{extensions:{KHR_texture_transform:i("metallicTexture")}}},extensions:{KHR_materials_anisotropy:{anisotropyStrength:{type:"number",get:(e,t,r)=>o(e,t,r).anisotropy.intensity,set:(e,t,r,n)=>{o(t,r,n).anisotropy.intensity=e},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"anisotropy.intensity"]},anisotropyRotation:{type:"number",get:(e,t,r)=>o(e,t,r).anisotropy.angle,set:(e,t,r,n)=>{o(t,r,n).anisotropy.angle=e},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"anisotropy.angle"]},anisotropyTexture:{extensions:{KHR_texture_transform:i("anisotropy","texture")}}},KHR_materials_clearcoat:{clearcoatFactor:{type:"number",get:(e,t,r)=>o(e,t,r).clearCoat.intensity,set:(e,t,r,n)=>{o(t,r,n).clearCoat.intensity=e},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"clearCoat.intensity"]},clearcoatRoughnessFactor:{type:"number",get:(e,t,r)=>o(e,t,r).clearCoat.roughness,set:(e,t,r,n)=>{o(t,r,n).clearCoat.roughness=e},getTarget:(e,t,r)=>o(e,t,r),getPropertyName:[()=>"clearCoat.roughness"]},clearcoatTexture:{extensions:{KHR_texture_transform:i("clearCoat","texture")}},clearcoatNormalTexture:{scale:{type:"number",get:(e,t,r)=>o(e,t,r).clearCoat.bumpTexture?.level,getTarget:o,set:(e,t,r,n)=>o(t,r,n).clearCoat.bumpTexture.level=e},extensions:{KHR_texture_transform:i("clearCoat","bumpTexture")}},clearcoatRoughnessTexture:{extensions:{KHR_texture_transform:i("clearCoat","textureRoughness")}}},KHR_materials_dispersion:{dispersion:{type:"number",get:(e,t,r)=>o(e,t,r).subSurface.dispersion,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.dispersion=e}},KHR_materials_emissive_strength:{emissiveStrength:{type:"number",get:(e,t,r)=>o(e,t,r).emissiveIntensity,getTarget:o,set:(e,t,r,n)=>o(t,r,n).emissiveIntensity=e}},KHR_materials_ior:{ior:{type:"number",get:(e,t,r)=>o(e,t,r).indexOfRefraction,getTarget:o,set:(e,t,r,n)=>o(t,r,n).indexOfRefraction=e}},KHR_materials_iridescence:{iridescenceFactor:{type:"number",get:(e,t,r)=>o(e,t,r).iridescence.intensity,getTarget:o,set:(e,t,r,n)=>o(t,r,n).iridescence.intensity=e},iridescenceIor:{type:"number",get:(e,t,r)=>o(e,t,r).iridescence.indexOfRefraction,getTarget:o,set:(e,t,r,n)=>o(t,r,n).iridescence.indexOfRefraction=e},iridescenceTexture:{extensions:{KHR_texture_transform:i("iridescence","texture")}},iridescenceThicknessMaximum:{type:"number",get:(e,t,r)=>o(e,t,r).iridescence.maximumThickness,getTarget:o,set:(e,t,r,n)=>o(t,r,n).iridescence.maximumThickness=e},iridescenceThicknessMinimum:{type:"number",get:(e,t,r)=>o(e,t,r).iridescence.minimumThickness,getTarget:o,set:(e,t,r,n)=>o(t,r,n).iridescence.minimumThickness=e},iridescenceThicknessTexture:{extensions:{KHR_texture_transform:i("iridescence","thicknessTexture")}}},KHR_materials_sheen:{sheenColorFactor:{type:"Color3",get:(e,t,r)=>o(e,t,r).sheen.color,getTarget:o,set:(e,t,r,n)=>o(t,r,n).sheen.color.copyFrom(e)},sheenColorTexture:{extensions:{KHR_texture_transform:i("sheen","texture")}},sheenRoughnessFactor:{type:"number",get:(e,t,r)=>o(e,t,r).sheen.intensity,getTarget:o,set:(e,t,r,n)=>o(t,r,n).sheen.intensity=e},sheenRoughnessTexture:{extensions:{KHR_texture_transform:i("sheen","thicknessTexture")}}},KHR_materials_specular:{specularFactor:{type:"number",get:(e,t,r)=>o(e,t,r).metallicF0Factor,getTarget:o,set:(e,t,r,n)=>o(t,r,n).metallicF0Factor=e,getPropertyName:[()=>"metallicF0Factor"]},specularColorFactor:{type:"Color3",get:(e,t,r)=>o(e,t,r).metallicReflectanceColor,getTarget:o,set:(e,t,r,n)=>o(t,r,n).metallicReflectanceColor.copyFrom(e),getPropertyName:[()=>"metallicReflectanceColor"]},specularTexture:{extensions:{KHR_texture_transform:i("metallicReflectanceTexture")}},specularColorTexture:{extensions:{KHR_texture_transform:i("reflectanceTexture")}}},KHR_materials_transmission:{transmissionFactor:{type:"number",get:(e,t,r)=>o(e,t,r).subSurface.refractionIntensity,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.refractionIntensity=e,getPropertyName:[()=>"subSurface.refractionIntensity"]},transmissionTexture:{extensions:{KHR_texture_transform:i("subSurface","refractionIntensityTexture")}}},KHR_materials_diffuse_transmission:{diffuseTransmissionFactor:{type:"number",get:(e,t,r)=>o(e,t,r).subSurface.translucencyIntensity,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.translucencyIntensity=e},diffuseTransmissionTexture:{extensions:{KHR_texture_transform:i("subSurface","translucencyIntensityTexture")}},diffuseTransmissionColorFactor:{type:"Color3",get:(e,t,r)=>o(e,t,r).subSurface.translucencyColor,getTarget:o,set:(e,t,r,n)=>e&&o(t,r,n).subSurface.translucencyColor?.copyFrom(e)},diffuseTransmissionColorTexture:{extensions:{KHR_texture_transform:i("subSurface","translucencyColorTexture")}}},KHR_materials_volume:{attenuationColor:{type:"Color3",get:(e,t,r)=>o(e,t,r).subSurface.tintColor,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.tintColor.copyFrom(e)},attenuationDistance:{type:"number",get:(e,t,r)=>o(e,t,r).subSurface.tintColorAtDistance,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.tintColorAtDistance=e},thicknessFactor:{type:"number",get:(e,t,r)=>o(e,t,r).subSurface.maximumThickness,getTarget:o,set:(e,t,r,n)=>o(t,r,n).subSurface.maximumThickness=e},thicknessTexture:{extensions:{KHR_texture_transform:i("subSurface","thicknessTexture")}}}}}},F={KHR_lights_punctual:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]},__array__:{__target__:!0,color:{type:"Color3",get:e=>e._babylonLight?.diffuse,set:(e,t)=>t._babylonLight?.diffuse.copyFrom(e),getTarget:e=>e._babylonLight,getPropertyName:[e=>"diffuse"]},intensity:{type:"number",get:e=>e._babylonLight?.intensity,set:(e,t)=>t._babylonLight?t._babylonLight.intensity=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"intensity"]},range:{type:"number",get:e=>e._babylonLight?.range,set:(e,t)=>t._babylonLight?t._babylonLight.range=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"range"]},spot:{innerConeAngle:{type:"number",get:e=>e._babylonLight?.innerAngle,set:(e,t)=>t._babylonLight?t._babylonLight.innerAngle=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"innerConeAngle"]},outerConeAngle:{type:"number",get:e=>e._babylonLight?.angle,set:(e,t)=>t._babylonLight?t._babylonLight.angle=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"outerConeAngle"]}}}}},EXT_lights_area:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]},__array__:{__target__:!0,color:{type:"Color3",get:e=>e._babylonLight?.diffuse,set:(e,t)=>t._babylonLight?.diffuse.copyFrom(e),getTarget:e=>e._babylonLight,getPropertyName:[e=>"diffuse"]},intensity:{type:"number",get:e=>e._babylonLight?.intensity,set:(e,t)=>t._babylonLight?t._babylonLight.intensity=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"intensity"]},size:{type:"number",get:e=>e._babylonLight?.height,set:(e,t)=>t._babylonLight?t._babylonLight.height=e:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"size"]},rect:{aspect:{type:"number",get:e=>e._babylonLight?.width/e._babylonLight?.height,set:(e,t)=>t._babylonLight?t._babylonLight.width=e*t._babylonLight.height:void 0,getTarget:e=>e._babylonLight,getPropertyName:[e=>"aspect"]}}}}},EXT_lights_ies:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonLight),getPropertyName:[e=>"length"]}}},EXT_lights_image_based:{lights:{length:{type:"number",get:e=>e.length,getTarget:e=>e.map(t=>t._babylonTexture),getPropertyName:[e=>"length"]},__array__:{__target__:!0,intensity:{type:"number",get:e=>e._babylonTexture?.level,set:(e,t)=>{t._babylonTexture&&(t._babylonTexture.level=e)},getTarget:e=>e._babylonTexture},rotation:{type:"Quaternion",get:e=>e._babylonTexture&&f.FromRotationMatrix(e._babylonTexture?.getReflectionTextureMatrix()),set:(e,t)=>{t._babylonTexture&&(t._babylonTexture.getScene()?.useRightHandedSystem||(e=f.Inverse(e)),c.FromQuaternionToRef(e,t._babylonTexture.getReflectionTextureMatrix()))},getTarget:e=>e._babylonTexture}}}}};function l(e,t,r,n){const a=o(e);return n?a[r][n]:a[r]}function o(e,t,r){return e._data?.[r?.fillMode??h.MATERIAL_TriangleFillMode]?.babylonMaterial}function i(e,t){return{offset:{componentsCount:2,type:"Vector2",get:(r,n,a)=>{const s=l(r,a,e,t);return new m(s?.uOffset,s?.vOffset)},getTarget:o,set:(r,n,a,s)=>{const g=l(n,s,e,t);g.uOffset=r.x,g.vOffset=r.y},getPropertyName:[()=>`${e}${t?"."+t:""}.uOffset`,()=>`${e}${t?"."+t:""}.vOffset`]},rotation:{type:"number",get:(r,n,a)=>l(r,a,e,t)?.wAng,getTarget:o,set:(r,n,a,s)=>l(n,s,e,t).wAng=r,getPropertyName:[()=>`${e}${t?"."+t:""}.wAng`]},scale:{componentsCount:2,type:"Vector2",get:(r,n,a)=>{const s=l(r,a,e,t);return new m(s?.uScale,s?.vScale)},getTarget:o,set:(r,n,a,s)=>{const g=l(n,s,e,t);g.uScale=r.x,g.vScale=r.y},getPropertyName:[()=>`${e}${t?"."+t:""}.uScale`,()=>`${e}${t?"."+t:""}.vScale`]}}}const u={cameras:P,nodes:C,materials:L,extensions:F,animations:N,meshes:R};function K(e){return new x(e,u)}function H(e){const t=e.split("/").map(n=>n.replace(/{}/g,"__array__"));let r=u;for(const n of t)n&&(r=r[n]);if(r&&r.type&&r.get)return r}function M(e,t){const r=e.split("/").map(a=>a.replace(/{}/g,"__array__"));let n=u;for(const a of r)a&&(n=n[a]);n&&n.type&&n.get&&(n.interpolation=t)}function w(e,t){const r=e.split("/").map(a=>a.replace(/{}/g,"__array__"));let n=u;for(const a of r)if(a){if(!n[a]){if(a==="?"){n.__ignoreObjectTree__=!0;continue}n[a]={},a==="__array__"&&(n[a].__target__=!0)}n=n[a]}Object.assign(n,t)}export{w as A,K as G,M as S,H as a};
