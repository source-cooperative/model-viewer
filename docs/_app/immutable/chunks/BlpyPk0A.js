import{h as s,q as g}from"./C6i2Uxh4.js";function B(e){const[n,i]=e.split(":");return v({op:n,extension:i})}function v(e,n=!0){const i=e.extension?f[e.extension]?.[e.op]:k[e.op];if(!i&&(s.Warn(`No mapping found for operation ${e.op} and extension ${e.extension||"KHR_interactivity"}`),n)){const r={},o={flows:{}};if(e.inputValueSockets){r.values={};for(const a in e.inputValueSockets)r.values[a]={name:a}}return e.outputValueSockets&&(o.values={},Object.keys(e.outputValueSockets).forEach(a=>{o.values[a]={name:a}})),{blocks:[],inputs:r,outputs:o}}return i}function b(e,n,i){f[n]||(f[n]={}),f[n][e]=i}const f={BABYLON:{"flow/log":{blocks:["FlowGraphConsoleLogBlock"],inputs:{values:{message:{name:"message"}}}}}},k={"event/onStart":{blocks:["FlowGraphSceneReadyEventBlock"],outputs:{flows:{out:{name:"done"}}}},"event/onTick":{blocks:["FlowGraphSceneTickEventBlock"],inputs:{},outputs:{values:{timeSinceLastTick:{name:"deltaTime",gltfType:"number"}},flows:{out:{name:"done"}}}},"event/send":{blocks:["FlowGraphSendCustomEventBlock"],extraProcessor(e,n,i,r,o){if(n.op!=="event/send"||!e.configuration||Object.keys(e.configuration).length!==1)throw new Error("Receive event should have a single configuration object, the event itself");const l=e.configuration.event.value?.[0];if(typeof l!="number")throw new Error("Event id should be a number");const u=r.arrays.events[l],p=o[0];return p.config||(p.config={}),p.config.eventId=u.eventId,p.config.eventData=u.eventData,o}},"event/receive":{blocks:["FlowGraphReceiveCustomEventBlock"],outputs:{flows:{out:{name:"done"}}},validation(e,n){if(!e.configuration)return s.Error("Receive event should have a configuration object"),{valid:!1,error:"Receive event should have a configuration object"};const i=e.configuration.event;if(!i)return s.Error("Receive event should have a single configuration object, the event itself"),{valid:!1,error:"Receive event should have a single configuration object, the event itself"};const r=i.value?.[0];return typeof r!="number"?(s.Error("Event id should be a number"),{valid:!1,error:"Event id should be a number"}):n.events?.[r]?{valid:!0}:(s.Error(`Event with id ${r} not found`),{valid:!1,error:`Event with id ${r} not found`})},extraProcessor(e,n,i,r,o){if(n.op!=="event/receive"||!e.configuration||Object.keys(e.configuration).length!==1)throw new Error("Receive event should have a single configuration object, the event itself");const l=e.configuration.event.value?.[0];if(typeof l!="number")throw new Error("Event id should be a number");const u=r.arrays.events[l],p=o[0];return p.config||(p.config={}),p.config.eventId=u.eventId,p.config.eventData=u.eventData,o}},"math/E":t("FlowGraphEBlock"),"math/Pi":t("FlowGraphPIBlock"),"math/Inf":t("FlowGraphInfBlock"),"math/NaN":t("FlowGraphNaNBlock"),"math/abs":t("FlowGraphAbsBlock"),"math/sign":t("FlowGraphSignBlock"),"math/trunc":t("FlowGraphTruncBlock"),"math/floor":t("FlowGraphFloorBlock"),"math/ceil":t("FlowGraphCeilBlock"),"math/round":{blocks:["FlowGraphRoundBlock"],configuration:{},inputs:{values:{a:{name:"a"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o){var a;return(a=o[0]).config||(a.config={}),o[0].config.roundHalfAwayFromZero=!0,o}},"math/fract":t("FlowGraphFractBlock"),"math/neg":t("FlowGraphNegationBlock"),"math/add":t("FlowGraphAddBlock",["a","b"],!0),"math/sub":t("FlowGraphSubtractBlock",["a","b"],!0),"math/mul":{blocks:["FlowGraphMultiplyBlock"],extraProcessor(e,n,i,r,o){var a;(a=o[0]).config||(a.config={}),o[0].config.useMatrixPerComponent=!0,o[0].config.preventIntegerFloatArithmetic=!0;let l=-1;return Object.keys(e.values||{}).find(u=>e.values?.[u].type!==void 0?(l=e.values[u].type,!0):!1),l!==-1&&(o[0].config.type=r.arrays.types[l].flowGraphType),o},validation(e){return e.values?h(e):{valid:!0}}},"math/div":t("FlowGraphDivideBlock",["a","b"],!0),"math/rem":t("FlowGraphModuloBlock",["a","b"]),"math/min":t("FlowGraphMinBlock",["a","b"]),"math/max":t("FlowGraphMaxBlock",["a","b"]),"math/clamp":t("FlowGraphClampBlock",["a","b","c"]),"math/saturate":t("FlowGraphSaturateBlock"),"math/mix":t("FlowGraphMathInterpolationBlock",["a","b","c"]),"math/eq":t("FlowGraphEqualityBlock",["a","b"]),"math/lt":t("FlowGraphLessThanBlock",["a","b"]),"math/le":t("FlowGraphLessThanOrEqualBlock",["a","b"]),"math/gt":t("FlowGraphGreaterThanBlock",["a","b"]),"math/ge":t("FlowGraphGreaterThanOrEqualBlock",["a","b"]),"math/isNaN":t("FlowGraphIsNaNBlock"),"math/isInf":t("FlowGraphIsInfBlock"),"math/select":{blocks:["FlowGraphConditionalBlock"],inputs:{values:{condition:{name:"condition"},a:{name:"onTrue"},b:{name:"onFalse"}}},outputs:{values:{value:{name:"output"}}}},"math/random":{blocks:["FlowGraphRandomBlock"],outputs:{values:{value:{name:"value"}}}},"math/sin":t("FlowGraphSinBlock"),"math/cos":t("FlowGraphCosBlock"),"math/tan":t("FlowGraphTanBlock"),"math/asin":t("FlowGraphASinBlock"),"math/acos":t("FlowGraphACosBlock"),"math/atan":t("FlowGraphATanBlock"),"math/atan2":t("FlowGraphATan2Block",["a","b"]),"math/sinh":t("FlowGraphSinhBlock"),"math/cosh":t("FlowGraphCoshBlock"),"math/tanh":t("FlowGraphTanhBlock"),"math/asinh":t("FlowGraphASinhBlock"),"math/acosh":t("FlowGraphACoshBlock"),"math/atanh":t("FlowGraphATanhBlock"),"math/exp":t("FlowGraphExponentialBlock"),"math/log":t("FlowGraphLogBlock"),"math/log2":t("FlowGraphLog2Block"),"math/log10":t("FlowGraphLog10Block"),"math/sqrt":t("FlowGraphSquareRootBlock"),"math/cbrt":t("FlowGraphCubeRootBlock"),"math/pow":t("FlowGraphPowerBlock",["a","b"]),"math/length":t("FlowGraphLengthBlock"),"math/normalize":t("FlowGraphNormalizeBlock"),"math/dot":t("FlowGraphDotBlock",["a","b"]),"math/cross":t("FlowGraphCrossBlock",["a","b"]),"math/rotate2D":{blocks:["FlowGraphRotate2DBlock"],inputs:{values:{a:{name:"a"},angle:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/rotate3D":{blocks:["FlowGraphRotate3DBlock"],inputs:{values:{a:{name:"a"},rotation:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/transform":{blocks:["FlowGraphTransformVectorBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/combine2":{blocks:["FlowGraphCombineVector2Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/combine3":{blocks:["FlowGraphCombineVector3Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/combine4":{blocks:["FlowGraphCombineVector4Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/extract2":{blocks:["FlowGraphExtractVector2Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"}}}},"math/extract3":{blocks:["FlowGraphExtractVector3Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"}}}},"math/extract4":{blocks:["FlowGraphExtractVector4Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"}}}},"math/transpose":t("FlowGraphTransposeBlock"),"math/determinant":t("FlowGraphDeterminantBlock"),"math/inverse":t("FlowGraphInvertMatrixBlock"),"math/matMul":t("FlowGraphMatrixMultiplicationBlock",["a","b"]),"math/matCompose":{blocks:["FlowGraphMatrixCompose"],inputs:{values:{translation:{name:"position",gltfType:"float3"},rotation:{name:"rotationQuaternion",gltfType:"float4"},scale:{name:"scaling",gltfType:"float3"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o,a){const l=o[0].dataInputs.find(u=>u.name==="rotationQuaternion");if(!l)throw new Error("Rotation quaternion input not found");return a._connectionValues[l.uniqueId]&&(a._connectionValues[l.uniqueId].type="Quaternion"),o}},"math/matDecompose":{blocks:["FlowGraphMatrixDecompose"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{translation:{name:"position"},rotation:{name:"rotationQuaternion"},scale:{name:"scaling"}}}},"math/quatConjugate":t("FlowGraphConjugateBlock",["a"]),"math/quatMul":{blocks:["FlowGraphMultiplyBlock"],inputs:{values:{a:{name:"a",gltfType:"vector4"},b:{name:"b",gltfType:"vector4"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o){var a;return(a=o[0]).config||(a.config={}),o[0].config.type="Quaternion",o}},"math/quatAngleBetween":t("FlowGraphAngleBetweenBlock",["a","b"]),"math/quatFromAxisAngle":{blocks:["FlowGraphQuaternionFromAxisAngleBlock"],inputs:{values:{axis:{name:"a",gltfType:"float3"},angle:{name:"b",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/quatToAxisAngle":t("FlowGraphAxisAngleFromQuaternionBlock",["a"]),"math/quatFromDirections":t("FlowGraphQuaternionFromDirectionsBlock",["a","b"]),"math/combine2x2":{blocks:["FlowGraphCombineMatrix2DBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o){var a;return(a=o[0]).config||(a.config={}),o[0].config.inputIsColumnMajor=!0,o}},"math/extract2x2":{blocks:["FlowGraphExtractMatrix2DBlock"],inputs:{values:{a:{name:"input",gltfType:"float2x2"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"}}}},"math/combine3x3":{blocks:["FlowGraphCombineMatrix3DBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"},e:{name:"input_4",gltfType:"number"},f:{name:"input_5",gltfType:"number"},g:{name:"input_6",gltfType:"number"},h:{name:"input_7",gltfType:"number"},i:{name:"input_8",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o){var a;return(a=o[0]).config||(a.config={}),o[0].config.inputIsColumnMajor=!0,o}},"math/extract3x3":{blocks:["FlowGraphExtractMatrix3DBlock"],inputs:{values:{a:{name:"input",gltfType:"float3x3"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"},4:{name:"output_4"},5:{name:"output_5"},6:{name:"output_6"},7:{name:"output_7"},8:{name:"output_8"}}}},"math/combine4x4":{blocks:["FlowGraphCombineMatrixBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"},e:{name:"input_4",gltfType:"number"},f:{name:"input_5",gltfType:"number"},g:{name:"input_6",gltfType:"number"},h:{name:"input_7",gltfType:"number"},i:{name:"input_8",gltfType:"number"},j:{name:"input_9",gltfType:"number"},k:{name:"input_10",gltfType:"number"},l:{name:"input_11",gltfType:"number"},m:{name:"input_12",gltfType:"number"},n:{name:"input_13",gltfType:"number"},o:{name:"input_14",gltfType:"number"},p:{name:"input_15",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o){var a;return(a=o[0]).config||(a.config={}),o[0].config.inputIsColumnMajor=!0,o}},"math/extract4x4":{blocks:["FlowGraphExtractMatrixBlock"],configuration:{},inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"},4:{name:"output_4"},5:{name:"output_5"},6:{name:"output_6"},7:{name:"output_7"},8:{name:"output_8"},9:{name:"output_9"},10:{name:"output_10"},11:{name:"output_11"},12:{name:"output_12"},13:{name:"output_13"},14:{name:"output_14"},15:{name:"output_15"}}}},"math/not":{blocks:["FlowGraphBitwiseNotBlock"],inputs:{values:{a:{name:"a"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o,a){var l;(l=o[0]).config||(l.config={});const u=o[0].dataInputs[0];return o[0].config.valueType=a._connectionValues[u.uniqueId]?.type??"FlowGraphInteger",o}},"math/and":{blocks:["FlowGraphBitwiseAndBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o,a){var l;(l=o[0]).config||(l.config={});const u=o[0].dataInputs[0],p=o[0].dataInputs[1];return o[0].config.valueType=a._connectionValues[u.uniqueId]?.type??a._connectionValues[p.uniqueId]?.type??"FlowGraphInteger",o}},"math/or":{blocks:["FlowGraphBitwiseOrBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o,a){var l;(l=o[0]).config||(l.config={});const u=o[0].dataInputs[0],p=o[0].dataInputs[1];return o[0].config.valueType=a._connectionValues[u.uniqueId]?.type??a._connectionValues[p.uniqueId]?.type??"FlowGraphInteger",o}},"math/xor":{blocks:["FlowGraphBitwiseXorBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(e,n,i,r,o,a){var l;(l=o[0]).config||(l.config={});const u=o[0].dataInputs[0],p=o[0].dataInputs[1];return o[0].config.valueType=a._connectionValues[u.uniqueId]?.type??a._connectionValues[p.uniqueId]?.type??"FlowGraphInteger",o}},"math/asr":t("FlowGraphBitwiseRightShiftBlock",["a","b"]),"math/lsl":t("FlowGraphBitwiseLeftShiftBlock",["a","b"]),"math/clz":t("FlowGraphLeadingZerosBlock"),"math/ctz":t("FlowGraphTrailingZerosBlock"),"math/popcnt":t("FlowGraphOneBitsCounterBlock"),"math/rad":t("FlowGraphDegToRadBlock"),"math/deg":t("FlowGraphRadToDegBlock"),"type/boolToInt":t("FlowGraphBooleanToInt"),"type/boolToFloat":t("FlowGraphBooleanToFloat"),"type/intToBool":t("FlowGraphIntToBoolean"),"type/intToFloat":t("FlowGraphIntToFloat"),"type/floatToInt":t("FlowGraphFloatToInt"),"type/floatToBool":t("FlowGraphFloatToBoolean"),"flow/sequence":{blocks:["FlowGraphSequenceBlock"],extraProcessor(e,n,i,r,o){const a=o[0];return a.config||(a.config={}),a.config.outputSignalCount=Object.keys(e.flows||[]).length,a.signalOutputs.forEach((l,u)=>{l.name="out_"+u}),o}},"flow/branch":{blocks:["FlowGraphBranchBlock"],outputs:{flows:{true:{name:"onTrue"},false:{name:"onFalse"}}}},"flow/switch":{blocks:["FlowGraphSwitchBlock"],configuration:{cases:{name:"cases",isArray:!0,inOptions:!0,defaultValue:[]}},inputs:{values:{selection:{name:"case"},default:{name:"default"}}},validation(e){const n=e.configuration?.cases;if(n&&n.value){if(!n.value.every(o=>typeof o=="number"&&/^-?\d+$/.test(o.toString())))return s.Warn("Switch cases should be integers. Using empty array instead."),n.value=[],{valid:!0};const r=new Set(n.value);n.value=Array.from(r)}return{valid:!0}},extraProcessor(e,n,i,r,o){if(n.op!=="flow/switch"||!e.flows||Object.keys(e.flows).length===0)throw new Error("Switch should have a single configuration object, the cases array");return o[0].signalOutputs.forEach(l=>{l.name!=="default"&&(l.name="out_"+l.name)}),o}},"flow/while":{blocks:["FlowGraphWhileLoopBlock"],outputs:{flows:{loopBody:{name:"executionFlow"}}}},"flow/for":{blocks:["FlowGraphForLoopBlock"],configuration:{initialIndex:{name:"initialIndex",gltfType:"number",inOptions:!0,defaultValue:0}},inputs:{values:{startIndex:{name:"startIndex",gltfType:"number"},endIndex:{name:"endIndex",gltfType:"number"}}},outputs:{values:{index:{name:"index"}},flows:{loopBody:{name:"executionFlow"}}},extraProcessor(e,n,i,r,o){const a=o[0];return a.config||(a.config={}),a.config.incrementIndexWhenLoopDone=!0,o}},"flow/doN":{blocks:["FlowGraphDoNBlock"],configuration:{},inputs:{values:{n:{name:"maxExecutions",gltfType:"number"}}},outputs:{values:{currentCount:{name:"executionCount"}}}},"flow/multiGate":{blocks:["FlowGraphMultiGateBlock"],configuration:{isRandom:{name:"isRandom",gltfType:"boolean",inOptions:!0,defaultValue:!1},isLoop:{name:"isLoop",gltfType:"boolean",inOptions:!0,defaultValue:!1}},extraProcessor(e,n,i,r,o){if(n.op!=="flow/multiGate"||!e.flows||Object.keys(e.flows).length===0)throw new Error("MultiGate should have a single configuration object, the number of output flows");const a=o[0];return a.config||(a.config={}),a.config.outputSignalCount=Object.keys(e.flows).length,a.signalOutputs.forEach((l,u)=>{l.name="out_"+u}),o}},"flow/waitAll":{blocks:["FlowGraphWaitAllBlock"],configuration:{inputFlows:{name:"inputSignalCount",gltfType:"number",inOptions:!0,defaultValue:0}},inputs:{flows:{reset:{name:"reset"},"[segment]":{name:"in_$1"}}},validation(e){return typeof e.configuration?.inputFlows?.value?.[0]!="number"&&(e.configuration=e.configuration||{inputFlows:{value:[0]}},e.configuration.inputFlows.value=[0]),{valid:!0}}},"flow/throttle":{blocks:["FlowGraphThrottleBlock"],outputs:{flows:{err:{name:"error"}}}},"flow/setDelay":{blocks:["FlowGraphSetDelayBlock"],outputs:{flows:{err:{name:"error"}}}},"flow/cancelDelay":{blocks:["FlowGraphCancelDelayBlock"]},"variable/get":{blocks:["FlowGraphGetVariableBlock"],validation(e){return e.configuration?.variable?.value?{valid:!0}:(s.Error("Variable get block should have a variable configuration"),{valid:!1,error:"Variable get block should have a variable configuration"})},configuration:{variable:{name:"variable",gltfType:"number",flowGraphType:"string",inOptions:!0,isVariable:!0,dataTransformer(e,n){return n.getVariableName(e)}}}},"variable/set":{blocks:["FlowGraphSetVariableBlock"],configuration:{variables:{name:"variables",gltfType:"number",flowGraphType:"string",inOptions:!0,isArray:!0,dataTransformer(e,n){return e.map(i=>n.getVariableName(i))}}},extraProcessor(e,n,i,r,o){return o[0].dataInputs.forEach(l=>{l.name=r.getVariableName(+l.name)}),o}},"variable/interpolate":{blocks:["FlowGraphInterpolationBlock","FlowGraphContextBlock","FlowGraphPlayAnimationBlock","FlowGraphBezierCurveEasing","FlowGraphGetVariableBlock"],configuration:{variable:{name:"propertyName",inOptions:!0,isVariable:!0,dataTransformer(e,n){return n.getVariableName(e)}},useSlerp:{name:"animationType",inOptions:!0,defaultValue:!1,dataTransformer(e){return e===!0?"Quaternion":void 0}}},inputs:{values:{value:{name:"value_1"},duration:{name:"duration_1",gltfType:"number"},p1:{name:"controlPoint1",toBlock:"FlowGraphBezierCurveEasing"},p2:{name:"controlPoint2",toBlock:"FlowGraphBezierCurveEasing"}},flows:{in:{name:"in",toBlock:"FlowGraphPlayAnimationBlock"}}},outputs:{flows:{err:{name:"error",toBlock:"FlowGraphPlayAnimationBlock"},out:{name:"out",toBlock:"FlowGraphPlayAnimationBlock"},done:{name:"done",toBlock:"FlowGraphPlayAnimationBlock"}}},interBlockConnectors:[{input:"object",output:"userVariables",inputBlockIndex:2,outputBlockIndex:1,isVariable:!0},{input:"animation",output:"animation",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0},{input:"easingFunction",output:"easingFunction",inputBlockIndex:0,outputBlockIndex:3,isVariable:!0},{input:"value_0",output:"value",inputBlockIndex:0,outputBlockIndex:4,isVariable:!0}],extraProcessor(e,n,i,r,o){var a,l;const u=o[0],p=e.configuration?.variable.value?.[0];if(typeof p!="number")throw s.Error("Variable index is not defined for variable interpolation block"),new Error("Variable index is not defined for variable interpolation block");const m=r.arrays.staticVariables[p];typeof u.config?.animationType?.value>"u"&&(u.config||(u.config={}),(a=u.config).animationType||(a.animationType={}),u.config.animationType.value=g(m.type));const c=o[4];return c.config||(c.config={}),(l=c.config).variable||(l.variable={}),c.config.variable.value=r.getVariableName(p),o}},"pointer/get":{blocks:["FlowGraphGetPropertyBlock","FlowGraphJsonPointerParserBlock"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customGetFunction",output:"getFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(e,n,i,r,o){return o.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"&&(a.config||(a.config={}),a.config.outputValue=!0)}),o}},"pointer/set":{blocks:["FlowGraphSetPropertyBlock","FlowGraphJsonPointerParserBlock"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{value:{name:"value"},"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customSetFunction",output:"setFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(e,n,i,r,o){return o.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"&&(a.config||(a.config={}),a.config.outputValue=!0)}),o}},"pointer/interpolate":{blocks:["FlowGraphInterpolationBlock","FlowGraphJsonPointerParserBlock","FlowGraphPlayAnimationBlock","FlowGraphBezierCurveEasing"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{value:{name:"value_1"},"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"},duration:{name:"duration_1",gltfType:"number"},p1:{name:"controlPoint1",toBlock:"FlowGraphBezierCurveEasing"},p2:{name:"controlPoint2",toBlock:"FlowGraphBezierCurveEasing"}},flows:{in:{name:"in",toBlock:"FlowGraphPlayAnimationBlock"}}},outputs:{flows:{err:{name:"error",toBlock:"FlowGraphPlayAnimationBlock"},out:{name:"out",toBlock:"FlowGraphPlayAnimationBlock"},done:{name:"done",toBlock:"FlowGraphPlayAnimationBlock"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:2,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customBuildAnimation",output:"generateAnimationsFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"animation",output:"animation",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0},{input:"easingFunction",output:"easingFunction",inputBlockIndex:0,outputBlockIndex:3,isVariable:!0},{input:"value_0",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(e,n,i,r,o){return o.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"?(a.config||(a.config={}),a.config.outputValue=!0):a.className==="FlowGraphInterpolationBlock"&&(a.config||(a.config={}),Object.keys(e.values||[]).forEach(l=>{const u=e.values?.[l];if(l==="value"&&u){const p=u.type;p!==void 0&&(a.config.animationType=r.arrays.types[p].flowGraphType)}}))}),o}},"animation/start":{blocks:["FlowGraphPlayAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"},speed:{name:"speed",gltfType:"number"},startTime:{name:"from",gltfType:"number",dataTransformer:(e,n)=>[e[0]*n._animationTargetFps]},endTime:{name:"to",gltfType:"number",dataTransformer:(e,n)=>[e[0]*n._animationTargetFps]}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(e,n,i,r,o,a,l){const u=o[o.length-1];return u.config||(u.config={}),u.config.glTF=l,o}},"animation/stop":{blocks:["FlowGraphStopAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(e,n,i,r,o,a,l){const u=o[o.length-1];return u.config||(u.config={}),u.config.glTF=l,o}},"animation/stopAt":{blocks:["FlowGraphStopAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],configuration:{},inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"},stopTime:{name:"stopAtFrame",gltfType:"number",dataTransformer:(e,n)=>[e[0]*n._animationTargetFps]}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(e,n,i,r,o,a,l){const u=o[o.length-1];return u.config||(u.config={}),u.config.glTF=l,o}},"math/switch":{blocks:["FlowGraphDataSwitchBlock"],configuration:{cases:{name:"cases",isArray:!0,inOptions:!0,defaultValue:[]}},inputs:{values:{selection:{name:"case"}}},validation(e){const n=e.configuration?.cases;if(n&&n.value){if(!n.value.every(o=>typeof o=="number"&&/^-?\d+$/.test(o.toString())))return s.Warn("Switch cases should be integers. Using empty array instead."),n.value=[],{valid:!0};const r=new Set(n.value);n.value=Array.from(r)}return{valid:!0}},extraProcessor(e,n,i,r,o){const a=o[0];return a.dataInputs.forEach(l=>{l.name!=="default"&&l.name!=="case"&&(l.name="in_"+l.name)}),a.config||(a.config={}),a.config.treatCasesAsIntegers=!0,o}},"debug/log":{blocks:["FlowGraphConsoleLogBlock"],configuration:{message:{name:"messageTemplate",inOptions:!0}}}};function t(e,n=["a"],i){return{blocks:[e],inputs:{values:n.reduce((r,o)=>(r[o]={name:o},r),{})},outputs:{values:{value:{name:"value"}}},extraProcessor(r,o,a,l,u){var p;if(i){(p=u[0]).config||(p.config={}),u[0].config.preventIntegerFloatArithmetic=!0;let m=-1;Object.keys(r.values||{}).find(c=>r.values?.[c].type!==void 0?(m=r.values[c].type,!0):!1),m!==-1&&(u[0].config.type=l.arrays.types[m].flowGraphType)}return u},validation(r){return i?h(r):{valid:!0}}}}function h(e){if(e.values){const n=Object.keys(e.values).map(r=>e.values[r].type).filter(r=>r!==void 0);if(!n.every(r=>r===n[0]))return{valid:!1,error:"All inputs must be of the same type"}}return{valid:!0}}export{b as a,B as b,v as g};
