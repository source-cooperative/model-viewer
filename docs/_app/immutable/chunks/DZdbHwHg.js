import{w as y,l as d,v as p,C as g,x as m,Q as w,u as E,r as F}from"./C6i2Uxh4.js";import{A as L,G as u}from"./DQP14zVN.js";const o="EXT_lights_area";class T{constructor(a){this.name=o,this._loader=a,this.enabled=this._loader.isExtensionUsed(o)}dispose(){this._loader=null,delete this._lights}onLoading(){const a=this._loader.gltf.extensions;if(a&&a[this.name]){const i=a[this.name];this._lights=i.lights,L.Assign(this._lights)}}loadNodeAsync(a,i,f){return u.LoadExtensionAsync(a,i,this.name,async(r,A)=>(this._loader._allMaterialsDirtyRequired=!0,await this._loader.loadNodeAsync(a,i,l=>{let e;const t=L.Get(r,this._lights,A.light),h=t.name||l.name;this._loader.babylonScene._blockEntityCollection=!!this._loader._assetContainer;const n=t.size!==void 0?t.size:1;switch(t.type){case"rect":{const s=t.rect?.aspect!==void 0?t.rect.aspect*n:n,b=n;e=new y(h,d.Zero(),s,b,this._loader.babylonScene);break}case"disk":{const s=Math.sqrt(n*n*.25*Math.PI);e=new y(h,d.Zero(),s,s,this._loader.babylonScene);break}default:throw this._loader.babylonScene._blockEntityCollection=!1,new Error(`${r}: Invalid area light type (${t.type})`)}e._parentContainer=this._loader._assetContainer,this._loader.babylonScene._blockEntityCollection=!1,t._babylonLight=e,e.falloffType=p.FALLOFF_GLTF,e.diffuse=t.color?g.FromArray(t.color):g.White(),e.intensity=t.intensity==null?1:t.intensity;const c=new m(`${h}_orientation`,this._loader.babylonScene);c.rotationQuaternion=w.RotationAxis(d.Up(),Math.PI),c.parent=l,e.parent=c,this._loader._babylonLights.push(e),u.AddPointerMetadata(e,r),f(l)})))}}E(o);F(o,!0,_=>new T(_));export{T as EXT_lights_area};
