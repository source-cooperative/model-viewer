import{C as h,u,r as d}from"./C6i2Uxh4.js";import{G as c}from"./DQP14zVN.js";const o="KHR_materials_volume";class m{constructor(r){this.name=o,this.order=173,this._loader=r,this.enabled=this._loader.isExtensionUsed(o),this.enabled&&this._loader._disableInstancedMesh++}dispose(){this.enabled&&this._loader._disableInstancedMesh--,this._loader=null}loadMaterialPropertiesAsync(r,i,a){return c.LoadExtensionAsync(r,i,this.name,async(e,s)=>{const t=new Array;return t.push(this._loader.loadMaterialPropertiesAsync(r,i,a)),t.push(this._loadVolumePropertiesAsync(e,i,a,s)),await Promise.all(t).then(()=>{})})}_loadVolumePropertiesAsync(r,i,a,e){const s=this._loader._getOrCreateMaterialAdapter(a);if(s.transmissionWeight===0&&s.subsurfaceWeight===0||!e.thicknessFactor)return Promise.resolve();s.transmissionDepth=e.attenuationDistance!==void 0?e.attenuationDistance:Number.MAX_VALUE,s.transmissionColor=e.attenuationColor!==void 0&&e.attenuationColor.length==3?h.FromArray(e.attenuationColor):h.White(),s.volumeThickness=e.thicknessFactor??0;const t=new Array;return e.thicknessTexture&&(e.thicknessTexture.nonColorData=!0,t.push(this._loader.loadTextureInfoAsync(`${r}/thicknessTexture`,e.thicknessTexture,l=>{l.name=`${a.name} (Thickness)`,s.volumeThicknessTexture=l}))),Promise.all(t).then(()=>{})}}u(o);d(o,!0,n=>new m(n));export{m as KHR_materials_volume};
